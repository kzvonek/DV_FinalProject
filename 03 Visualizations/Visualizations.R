#Visualizations
viz1 <- dfSTATEHOUSING %>% ggplot(aes(x=STATE)) + geom_bar(aes(y=POPULATION, fill=HOUSING), stat="identity") + geom_pointrange(aes(y=LANDAREA*100, ymax=LANDAREA*100, ymin=POPULATION, color=LANDAREA*100), size=1, shape=15) + scale_y_continuous(labels = comma, breaks=seq(0, 55000000, by=5000000)) + scale_fill_continuous(low="blue", high="orange", labels=comma, breaks=seq(2000000, 12000000, by=2000000)) + scale_color_continuous(low="dark green", high="brown", labels=comma, breaks=seq(10000000, 50000000, by=10000000))
#Shows Population by state as the bars, Housing by state as color fill, and landarea*100 as points with a line segment showing the difference between landarea*100 and population. This shows that landarea is not necessarily related to population or amount of housing.
viz2 <- dfSTATEHOUSINGTOTALS %>% ggplot(aes(x=EMP_RATE, y=AVG_PAY))+geom_point(aes(size=POPULATION, color=NUM_ESTABLISHMENTS))+geom_smooth(method=lm, color="dark green", fill="green", size=1, linetype=5) + geom_line(group=1, linetype=2, size=0.25) + scale_y_continuous(labels = dollar, breaks=seq(0, 27, by=3)) + scale_x_continuous(labels = percent, breaks=seq(.3, .5, by=.025)) + scale_color_continuous(low="blue", high="red", labels=comma) + scale_size_continuous(range=c(3,10), labels=comma, breaks=seq(0, 55000000, by=5000000))
#Shows scatterplot with connecting line and linear regression of employment rate and average payroll per person. Shows a strong correlation between payment and employment rate. Also shows number of establishments and population.
viz3 <- melt(dfNormalized) %>% ggplot(aes(fill=variable))+geom_density(aes(x=value,alpha=.2)) + stat_function(fun = dnorm, linetype=2) + geom_vline(aes(xintercept=mean(value)),linetype="dashed", size=1) + scale_y_continuous(labels = percent, breaks=seq(0,.45,by=.05)) + scale_x_continuous(labels = comma, breaks=seq(-6,10,by=1))
#Shows normalized distributions of Average Employment, Average Payroll, and Average Growth rate. Also shows a normal distribution for comparison. This shows how "normal" these distributions are, or not.
